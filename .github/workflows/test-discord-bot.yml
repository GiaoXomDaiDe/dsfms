name: Deploy Notifications

on:
  workflow_run:
    workflows: ["Deploy"]
    types:
      - completed

jobs:
  notify-deployment:
    name: Notify Deployment Status
    runs-on: ubuntu-latest
    if: github.event.workflow_run.head_branch == 'main'
    steps:
      - name: Notify Deployment Success
        if: github.event.workflow_run.conclusion == 'success'
        uses: appleboy/discord-action@v1.2.0
        with:
          webhook_url: ${{ secrets.WEBHOOK_URL }}
          color: "#28a745"
          username: "DSFMS Bot"
          message: |
            ‚úÖ **DEPLOYMENT SUCCESSFUL**

            Repository: ${{ github.repository }}
            Branch: ${{ github.event.workflow_run.head_branch }}
            Status: Production deployment completed

            üöÄ Application is now live!

            View Details: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.event.workflow_run.id }}

      - name: Notify Deployment Failure
        if: github.event.workflow_run.conclusion == 'failure'
        uses: appleboy/discord-action@v1.2.0
        with:
          webhook_url: ${{ secrets.WEBHOOK_URL }}
          color: "#dc3545"
          username: "DSFMS Bot"
          message: |
            ‚ùå **DEPLOYMENT FAILED**

            Repository: ${{ github.repository }}
            Branch: ${{ github.event.workflow_run.head_branch }}
            Status: Deployment failed

            üîß Please check the logs.

            View Logs: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.event.workflow_run.id }}

      - name: Notify Deployment Cancelled
        if: github.event.workflow_run.conclusion == 'cancelled'
        uses: appleboy/discord-action@v1.2.0
        with:
          webhook_url: ${{ secrets.WEBHOOK_URL }}
          color: "#ffc107"
          username: "DSFMS Bot"
          message: |
            ‚ö†Ô∏è **DEPLOYMENT CANCELLED**

            Repository: ${{ github.repository }}
            Branch: ${{ github.event.workflow_run.head_branch }}
            Status: Deployment was cancelled

            View Details: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.event.workflow_run.id }}
